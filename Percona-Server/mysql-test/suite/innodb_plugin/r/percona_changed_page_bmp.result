DROP TABLE IF EXISTS t1, t2;
CREATE TABLE t1 (x INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
CREATE TABLE t2 (x INT) ENGINE=InnoDB;
INSERT INTO t2 VALUES (1),(2),(3),(4),(5);
INSERT INTO t1 SELECT x FROM t1;
SET GLOBAL INNODB_FAST_SHUTDOWN=2;
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
call mtr.add_suppression("InnoDB: Warning: truncated block detected.*");
INSERT INTO t1 SELECT x FROM t1;
ERROR HY000: Lost connection to MySQL server during query
DROP TABLE t1, t2;
